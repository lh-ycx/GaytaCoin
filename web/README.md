# javascript及web应用开发 大作业

## 分工

|  姓名  |    学号    |                 负责部分                  |
| :----: | :--------: | :---------------------------------------: |
| 杨程旭 | 1500012863 | 登陆功能、设置签到功能、添加/删除课程功能 |
| 王乐强 | 1500012938 |        查看签到功能、修改密码功能         |

## 功能

### **1.简介**:
这是签到平台的前端网页, 老师可以登录这个平台并管理自己课程的签到信息。

**注：如果测试时有任何问题，请加微信18811586058，因为服务器没有一直打开，没有后端的话网页的功能不能完整实现。**

### **2.登录和用户**
平台没有注册功能，老师的账户和密码是通过管理员手动添加<br><br>

如果需要测试的话请使用账号：1500012863，密码：admin <br><br>
老师登录后可以自行修改密码<br><br>
点开“修改密码”一栏即可修改登录密码

### **3.添加/删除课程**
点开“我的课程一栏，表格中显示当前登录的老师的所有课程<br><br>
可以在每行点击”删除“按钮删除这个课程， 也可以在右下角的”添加“课程输入指定名字的课程<br><br>
课程号自动递增

### **4.设置签到**
点开”设置签到“一栏，选好课程和签到的ddl即可生成一个二维码<br><br>
学生通过微信小程序扫这个二维码在平台上登记自己的签到信息，过了ddl就没法签到了<br><br>
此外，使用了web api获取了设备的地理位置，防止出现学生在宿舍扫码签到的情况。

### **5.查看签到**
点开”查看签到”一栏，选择课程， 会显示出该课程所有学生的签到信息<br><br>
表格支持查询功能

<br><br><br><br>

## 一些具体实现
### **1.动态签到表格**
动态表格是用[*bootstrap-table*](https://github.com/wenzhixin/bootstrap-table)框架实现的， 相当于封装的ajax + html DOM 操作 <br><br>
由于这个签到表格默认是一次性加载所有表格的，也就是所有表格加载的参数都是第一次确定的<br><br>
*bootstrap-table*有refresh操作， refresh的参数是第一次建表的参数， 然而签到信息一栏需要实现的是点不同的课程显示不同课程(id)对应的签到表格，也就refresh表格的时候是要给服务器发不同的课程id信息<br><br>
这里用到了javascript引用类型的便利。先设定一个表示课程id的全局变量， 并且给服务器发送的参数传入这个全局变量， 每次refresh的时候根据选择的课程改变这个全局变量的值， 这样实际给服务器发送的参数也改变了。因为实现设定好的参数中"课程id"实际上是值全局变量的引用，并不是具体的值

### **2.检测登录**
直接打开操作数据的页面会提示“您还未登录，清先登录”的提示并跳转到登录页面
检测是否处于登录状态首先检测url的参数<br><br>
处于登录状态的url应该是 *[page address]?teacherid=xxx*，如果没有teacherid的参数需要先登录<br><br>
如果url有teacherid的参数， 会向后端发送查询该teacherid登录状态的信息， 后端会维护用户的登录状态<br><br>
如果后端发现teacherid不合法或者不在登录状态（登出或登录超时）， 则会返回错误信息， 前端收到错误信息会提示重新登录

### 3.使用到的库

整体基于bootstrap和jquery,使用了一些其他的库，包括：

1.**bootstrap-table**:https://github.com/wenzhixin/bootstrap-table

从后端获取信息并以表格的形式展示。

2.**bootstrap-datepicker**:https://github.com/uxsolutions/bootstrap-datepicker

用于设置签到时选择时间

3.**jquery-qrcode**:https://github.com/jeromeetienne/jquery-qrcode

用于生成二维码的库

4.**GPS**:https://blog.csdn.net/woshimuyi1025/article/details/49756005

web api获得的坐标是wgs84坐标系下的坐标，需要转换成gcj_02坐标系下的坐标。

